<!doctype html>
<html lang="he" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover">
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#10b981">
<title>KidRoutine Son â­</title>
<style>
:root{--bg:#f0fff7;--text:#111;--muted:#047857;--brand:#10b981}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Heebo,Arial;background:#f0fff7;color:var(--text)}
header{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:#ffffffd0;border-bottom:2px solid #dcfce7;position:sticky;top:0}
.brand{font-weight:900}.badge{border:2px dashed #86efac;border-radius:999px;padding:6px 12px;font-size:12px;color:#065f46;background:#ecfdf5}
main{max-width:560px;margin:0 auto;padding:12px}.card{background:#fff;border:2px solid #dcfce7;border-radius:22px;padding:12px;margin:14px 0;box-shadow:0 8px 0 #86efac}
.title{font-weight:900;font-size:22px}.muted{color:var(--muted);font-size:13px}
.tabs{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;background:#d1fae5;border-radius:16px;padding:6px}
.tabs button{background:#a7f3d0;border:2px solid #6ee7b7;border-radius:12px;padding:10px;font-weight:900;cursor:pointer}
.tabs .active{background:#fff;border-color:#34d399;box-shadow:0 4px 0 #6ee7b7}
.progress{height:14px;background:#dcfce7;border-radius:999px;overflow:hidden;border:2px solid #6ee7b7}.progress>div{height:100%;background:linear-gradient(90deg,#60a5fa,#10b981);width:0%}
.grid{display:grid;gap:10px}.task{display:flex;align-items:center;gap:12px;padding:12px;border:2px solid #bbf7d0;border-radius:16px;background:#fff;box-shadow:0 4px 0 #86efac}
.icon{width:60px;height:60px;display:grid;place-items:center;background:#ecfeff;border:2px solid #bae6fd;border-radius:14px;font-size:36px;cursor:pointer}
.name{font-size:18px;font-weight:900}.mini{font-size:12px;color:#0f766e}
.toggle{width:64px;height:36px;border-radius:999px;background:#fde68a;border:2px solid #fbbf24;position:relative;cursor:pointer}
.toggle::after{content:"";position:absolute;inset:3px;width:28px;border-radius:999px;background:#fff;transition:transform .2s}
.toggle.on{background:#86efac;border-color:#34d399}.toggle.on::after{transform:translateX(24px)}
.btn{appearance:none;border:none;border-radius:12px;padding:10px 12px;background:#10b981;color:#fff;font-weight:900;cursor:pointer;box-shadow:0 4px 0 #059669}
.btn.ghost{background:#f0fdf4;color:#065f46;border:2px solid #86efac;box-shadow:none}
.chips{display:flex;gap:8px;flex-wrap:wrap}.chip{background:#ecfeff;border:2px solid #bae6fd;border-radius:999px;padding:6px 10px;font-weight:900}
.shelf{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}.slot{height:72px;border:2px dashed #a7f3d0;border-radius:12px;display:grid;place-items:center;background:#fff}.slot.filled{border-style:solid;background:#f0fdf4}
.small{font-size:12px;color:#64748b}

/* big sticker */
.sticker{position:absolute;font-size:72px;transform:rotate(-12deg) scale(0.7);opacity:0;animation:stick .9s ease-out forwards;transform-origin:center}
@keyframes stick{0%{opacity:0;transform:rotate(-12deg) scale(0.7) translate(0,-20px)}60%{opacity:1;transform:rotate(8deg) scale(1.1)}100%{opacity:1;transform:rotate(0) scale(1)}}
/* base */
:root{--card:#fff}
*{box-sizing:border-box}
.row{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.edit-list{display:grid;gap:8px;margin-top:8px}
.edit-item{display:flex;gap:6px;align-items:center}
.edit-item input{padding:8px;border:2px solid #e2e8f0;border-radius:10px}
.edit-item button{padding:8px 10px;border-radius:10px;border:2px solid #e2e8f0;background:#fff;cursor:pointer}
hr.sep{border:none;border-top:1px dashed #e2e8f0;margin:10px 0}
.modal-bg{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;z-index:50}
.modal{background:#fff;border:3px solid #fcd34d;border-radius:22px;padding:18px;max-width:320px;text-align:center;box-shadow:0 10px 0 #f59e0b}
.modal .gift{font-size:80px}
</style>
</head>
<body>
<header><div class="brand">KidRoutine Son â­</div><div><button id="install" class="btn" style="display:none">×”×ª×§× ×”</button><span class="badge" id="st">×•×•×‘</span></div></header>
<main>
<section class="card"><div class="title">×©×œ×•× <span id="nm">×—××•×“/×”</span>! ğŸŒˆ</div><div class="muted" id="sub">×‘×•××• ×¢×•×©×™× ××©×™××•×ª ×‘×›×™×£</div>
<div class="progress"><div id="p" style="width:0%"></div></div><div class="muted">×”×ª×§×“××•×ª: <span id="pt">0%</span> | ×›×•×›×‘×™×: <span id="sc">0</span></div></section>
<div class="tabs card"><button id="t1" class="active">×‘×•×§×¨ ğŸŒ</button><button id="t2">×¢×¨×‘ ğŸŒ™</button><button id="t3">×—×™×–×•×§×™× â­</button></div>
<section id="list" class="card grid"></section>
<section class="card"><div class="title">×¤×¨×¡×™× ×•××“×‘×§×•×ª</div><div class="muted">×¦×•×‘×¨×™× ××˜×‘×¢×•×ª â†’ ×§×•× ×™× ××“×‘×§×•×ª ×œ××“×£</div>
<div class="chips" id="wal"></div><div style="display:flex;gap:8px;margin:8px 0"><button class="btn" id="b1">ğŸ˜€ (5)</button><button class="btn" id="b2">â­ (5)</button><button class="btn" id="b3">ğŸ† (10)</button></div><div class="shelf" id="sh"></div></section>
<section class="card"><div class="title">×œ×”×•×¨×”</div><div class="row"><label>×©× ×”×™×œ×“/×”:</label><input id="kname" placeholder="×—××•×“/×”" style="max-width:220px;padding:10px;border:2px solid #e5e7eb;border-radius:12px">
<button class="btn ghost" id="clr">× ×™×§×•×™ ×›×œ ×”× ×ª×•× ×™×</button></div>
<hr class="sep">
<div class="title" style="font-size:18px">× ×™×”×•×œ ××©×™××•×ª</div><div class="row"><select id="scope"><option value="morning">×‘×•×§×¨</option><option value="evening">×¢×¨×‘</option><option value="motives">×—×™×–×•×§×™×</option></select>
<input id="nt" placeholder="×›×•×ª×¨×ª ××©×™××”" style="flex:1;min-width:200px"><input id="nmv" type="number" min="0" placeholder="×“×§×•×ª (××•×¤×¦×™×•× ×œ×™)" style="width:140px"><button class="btn" id="add">×”×•×¡×£/×™</button></div>
<div class="edit-list" id="elist"></div>
<hr class="sep">
<div class="row"><label>×§×¨×™×™× ×•×ª:</label><input type="checkbox" id="von"><select id="vsel"></select><label class="small">××”×™×¨×•×ª</label><input type="range" id="vr" min="0.6" max="1.4" step="0.05" value="1"><label class="small">×’×•×‘×”</label><input type="range" id="vp" min="0.6" max="1.4" step="0.05" value="1"><button class="btn ghost" id="vtest">×‘×“×™×§×ª ×§×•×œ</button></div></section>
</main>
<div class="modal-bg" id="gift"><div class="modal"><div class="gift">ğŸ</div><h3>×™×©! ×”×’×¢×ª× ×œÖ¾5 ×›×•×›×‘×™×!</h3><p>××’×™×¢×” ××ª× ×” ğŸ</p><button class="btn" id="gx">×™××™×™!</button></div></div>
<script>
const APP="KidRoutine-Son";
const ICONS={"×œ×”×ª×¢×•×¨×¨ ×‘×–××Ÿ": "â°", "×œ×”×ª×¢×•×¨×¨ ×¢× ×—×™×•×š": "ğŸŒ", "×œ×œ×›×ª ×œ×©×™×¨×•×ª×™×": "ğŸš½", "×¤×™×¤×™/×—×™×ª×•×œ": "ğŸ§·", "×œ×¦×—×¦×— ×©×™× ×™×™× ×•×œ×©×˜×•×£ ×¤× ×™×": "ğŸª¥", "×œ×¦×—×¦×— ×©×™× ×™×™× (×¢× ×¢×–×¨×”)": "ğŸª¥", "×œ×¦×—×¦×— ×©×™× ×™×™×": "ğŸª¥", "×œ×©×˜×•×£ ×™×“×™×™× ×•×¤× ×™×": "ğŸ«§", "×œ×”×ª×œ×‘×© ×œ×‘×“": "ğŸ‘•", "×œ×”×ª×œ×‘×© (×¢× ×¢×–×¨×”)": "ğŸ‘—", "×œ××›×•×œ ××¨×•×—×ª ×‘×•×§×¨": "ğŸ¥£", "×œ××›×•×œ ××¨×•×—×ª ×‘×•×§×¨ ×§×˜× ×”": "ğŸ“", "×œ×§×—×ª ×ª×™×§ ×•×‘×§×‘×•×§ ××™×": "ğŸ’", "×œ×§×—×ª ×“×•×‘×™/××•×¦×¥/×‘×§×‘×•×§ ××™×": "ğŸ§¸", "×œ××¡×•×£ ×¦×¢×¦×•×¢×™×": "ğŸ§¸", "×©×™×¢×•×¨×™ ×‘×™×ª": "âœï¸", "×œ×”×›×™×Ÿ ×‘×’×“×™× ×œ××—×¨": "ğŸ‘š", "×¡×™×¤×•×¨ ×œ×¤× ×™ ×”×©×™× ×”": "ğŸ“–", "××§×œ×—×ª/×©×˜×™×¤×”": "ğŸ›", "×¤×™×’×³××” × ×•×—×”": "ğŸ›Œ", "×œ× ×¢×•×œ × ×¢×œ×™×™×": "ğŸ‘Ÿ", "×”×›×™×¨ ×—×‘×¨ ×—×“×©": "ğŸ¤", "×©×™×—×§ ×™×¤×” ×¢× ××—×¨×™×": "âš½", "×¢×©×” ×¤×™×¤×™/×§×§×™ ×‘×‘×™×ª ×”×¡×¤×¨": "ğŸŒŸ", "×¡×™×¤×¨×” ×œ××—× ×›×ª ×›×©×¦×¨×™×š ×¤×™×¤×™": "ğŸš½", "××™×œ× ××™× ×œ×‘×“": "ğŸš°", "××›×œ×” ×™×¤×” ×‘×’×Ÿ": "ğŸ¥£", "× ×× ××” ×˜×•×‘ ğŸŒ™": "ğŸŒ™", "×”×©×ª×ª×¤×” ×‘××¢×’×œ ×©×™×—×”/×©×™×¨×™×": "ğŸ¶", "×¢×–×¨ ×œ××•×¨×”": "ğŸ", "×××¨×” ×‘×‘×§×©×”/×ª×•×“×”": "ğŸ’¬"};
function iconFor(t){ return ICONS[t] || "â­"; }
const LS=(k,d)=>{ try{ return JSON.parse(localStorage.getItem(APP+':'+k)) ?? d }catch{ return d } };
const SET=(k,v)=>{ try{ localStorage.setItem(APP+':'+k, JSON.stringify(v)) }catch{} };
let tab=LS('tab','morning'), nameVal=LS('kidName','×—××•×“/×”');
let morning=LS('morningTasks', [["×œ×”×ª×¢×•×¨×¨ ×‘×–××Ÿ", 2], ["×œ×œ×›×ª ×œ×©×™×¨×•×ª×™×", 3], ["×œ×¦×—×¦×— ×©×™× ×™×™× ×•×œ×©×˜×•×£ ×¤× ×™×", 3], ["×œ×”×ª×œ×‘×© ×œ×‘×“", 5], ["×œ××›×•×œ ××¨×•×—×ª ×‘×•×§×¨", 10], ["×œ×§×—×ª ×ª×™×§ ×•×‘×§×‘×•×§ ××™×", 1]].map(x=>({id:crypto.randomUUID(),title:x[0],...(x[1]?{minutes:x[1]}:{})})));
let evening=LS('eveningTasks', [["×œ××¡×•×£ ×¦×¢×¦×•×¢×™×", 5], ["×œ×”×›×™×Ÿ ×ª×™×§ ×œ×‘×™×ª ×”×¡×¤×¨", 4], ["×©×™×¢×•×¨×™ ×‘×™×ª", 20], ["×œ×”×›×™×Ÿ ×‘×’×“×™× ×œ××—×¨", 3], ["×œ×¦×—×¦×— ×©×™× ×™×™×", 3], ["×¡×™×¤×•×¨ ×œ×¤× ×™ ×”×©×™× ×”", 10]].map(x=>({id:crypto.randomUUID(),title:x[0],...(x[1]?{minutes:x[1]}:{})})));
let motives=LS('motives', ["×”×›×™×¨ ×—×‘×¨ ×—×“×©", "×©×™×—×§ ×™×¤×” ×¢× ××—×¨×™×", "×¢×©×” ×¤×™×¤×™/×§×§×™ ×‘×‘×™×ª ×”×¡×¤×¨", "××™×œ× ××™× ×œ×‘×“", "×¢×–×¨ ×œ××•×¨×”"].map(t=>({id:crypto.randomUUID(),title:t})));
let today=new Date().toDateString(); let done=LS('doneToday',{date:today,morning:{},evening:{},motives:{}}); if(done.date!==today){ done={date:today,morning:{},evening:{},motives:{}}; SET('doneToday',done); }
let coins=LS('coins',0), stars=LS('stars',0), shelf=LS('shelf',Array(8).fill(null));
// voice
let voiceOn=LS('voiceOn',true), voiceName=LS('voiceName',''), voiceRate=LS('voiceRate',1), voicePitch=LS('voicePitch',1), voices=[];
function loadVoices(){ voices=speechSynthesis.getVoices().filter(v=>/he|Hebrew/i.test(v.lang)||/Hebrew/i.test(v.name)); const s=document.querySelector('#vsel'); s.innerHTML=''; if(voices.length===0) voices=speechSynthesis.getVoices(); voices.forEach(v=>{ const o=document.createElement('option'); o.value=v.name; o.textContent=v.name+' ('+v.lang+')'; if(v.name===voiceName) o.selected=true; s.appendChild(o); }); if(!voiceName && voices[0]) voiceName=voices[0].name; }
if('speechSynthesis' in window){ loadVoices(); window.speechSynthesis.onvoiceschanged=loadVoices; }
function say(t){ if(!voiceOn || !('speechSynthesis' in window)) return; const u=new SpeechSynthesisUtterance(t); const v=voices.find(x=>x.name===voiceName)||voices.find(x=>/he|Hebrew/i.test(x.lang))||voices[0]; if(v) u.voice=v; u.lang=(v&&v.lang)||'he-IL'; u.rate=parseFloat(voiceRate)||1; u.pitch=parseFloat(voicePitch)||1; try{ speechSynthesis.cancel(); speechSynthesis.speak(u); }catch{} }
const el=s=>document.querySelector(s), mk=t=>document.createElement(t);
const save=()=>{ SET('tab',tab); SET('kidName',nameVal); SET('morningTasks',morning); SET('eveningTasks',evening); SET('motives',motives); SET('doneToday',done); SET('coins',coins); SET('stars',stars); SET('shelf',shelf); SET('voiceOn',voiceOn); SET('voiceName',voiceName); SET('voiceRate',voiceRate); SET('voicePitch',voicePitch); };
function prog(kind){ const list=(kind==='morning'?morning:evening), map=done[kind]; const tot=list.length||1, c=list.filter(t=>map[t.id]).length; return Math.round(100*c/tot); }
function header(){ el('#nm').textContent=nameVal; const p=tab==='morning'?prog('morning'):tab==='evening'?prog('evening'):0; el('#p').style.width=p+'%'; el('#pt').textContent=p+'%'; el('#sub').textContent=tab==='morning'?'×‘×•××• ×¢×•×©×™× ××©×™××•×ª ×‘×›×™×£':(tab==='evening'?'× ×¡×™×™× ×‘× ×¢×™××™× ×•× ×œ×š ×œ×™×©×•×Ÿ':'××¡×× ×™× ×”×¦×œ×—×•×ª ×™×•××™×•××™×•×ª'); el('#sc').textContent=stars; }
function sticker(target, txt){ const s=mk('div'); s.className='sticker'; s.textContent=txt; const r=target.getBoundingClientRect(); s.style.left=(r.left + r.width/2)+'px'; s.style.top=(r.top - 10 + window.scrollY)+'px'; document.body.appendChild(s); setTimeout(()=>s.remove(),1100); }
function row(t, checked, onT){ const r=mk('div'); r.className='task'; const i=mk('div'); i.className='icon'; i.textContent=iconFor(t.title); i.title=t.title; i.onclick=e=>{ e.stopPropagation(); say(t.title); }; const tx=mk('div'); tx.innerHTML='<div class="name">'+t.title+'</div>'+(t.minutes?'<div class="mini">×–××Ÿ ××•×¦×¢: '+t.minutes+' ×“×§×³</div>':''); const g=mk('div'); g.className='toggle'+(checked?' on':''); g.onclick=e=>{ e.stopPropagation(); onT(g); }; r.onclick=e=>onT(g); r.append(i,tx,g); return r; }
function gift(){ if(stars>0 && stars%5===0) el('#gift').style.display='flex'; }
function render(){ const box=el('#list'); box.innerHTML=''; if(tab==='morning'||tab==='evening'){ const list=(tab==='morning'?morning:evening), map=done[tab]; list.forEach(t=>{ box.appendChild(row(t, !!map[t.id], g=>{ const was=!!map[t.id]; map[t.id]=!was; g.classList.toggle('on', !!map[t.id]); if(!was){ coins+=1; sticker(g,'ğŸ‰'); say('×¡×™×™××ª ××ª ×”××©×™××”: ' + t.title); } save(); header(); wallet(); if(prog(tab)===100 && !was){ stars+=1; save(); header(); wallet(); gift(); } })); }); } else { const map=done.motives; motives.forEach(m=>{ box.appendChild(row({id:m.id,title:m.title}, !!map[m.id], g=>{ const was=!!map[m.id]; map[m.id]=!was; g.classList.toggle('on', !!map[m.id]); if(!was){ coins+=2; sticker(g,'âœ¨'); say('×¡×™×™××ª ××ª ×”××©×™××”: ' + m.title); } save(); header(); wallet(); })); }); } }
function tabs(){ document.querySelectorAll('.tabs button').forEach(b=>b.classList.remove('active')); if(tab==='morning') el('#t1').classList.add('active'); else if(tab==='evening') el('#t2').classList.add('active'); else el('#t3').classList.add('active'); }
function wallet(){ const w=el('#wal'); w.innerHTML=''; const a=mk('span'); a.className='chip'; a.textContent='××˜×‘×¢×•×ª: '+coins; const b=mk('span'); b.className='chip'; b.textContent='×›×•×›×‘×™×: '+stars; w.append(a,b); }
function shelfR(){ const s=el('#sh'); s.innerHTML=''; shelf.forEach(v=>{ const d=mk('div'); d.className='slot'+(v?' filled':''); d.textContent=v||'â€”'; s.appendChild(d); }); }
function editR(){ const sc=el('#scope').value; const list=sc==='morning'?morning:sc==='evening'?evening:motives; const w=el('#elist'); w.innerHTML=''; list.forEach((t,i)=>{ const r=mk('div'); r.className='edit-item'; const a=mk('input'); a.value=t.title; a.style.flex='1'; const m=mk('input'); m.type='number'; m.min='0'; m.placeholder='×“×§×•×ª'; m.style.width='90px'; if(t.minutes!=null) m.value=t.minutes; const sp=mk('button'); sp.textContent='ğŸ“¢'; sp.onclick=()=>say(a.value); const up=mk('button'); up.textContent='â†‘'; const dn=mk('button'); dn.textContent='â†“'; const del=mk('button'); del.textContent='××—×§'; r.append(a,m,sp,up,dn,del); w.appendChild(r); a.oninput=()=>{ t.title=a.value; save(); render(); }; m.oninput=()=>{ const v=parseInt(m.value||'0',10); t.minutes=isNaN(v)?null:v; save(); render(); }; up.onclick=()=>{ if(i>0){ [list[i-1],list[i]]=[list[i],list[i-1]]; save(); editR(); render(); } }; dn.onclick=()=>{ if(i<list.length-1){ [list[i+1],list[i]]=[list[i],list[i+1]]; save(); editR(); render(); } }; del.onclick=()=>{ list.splice(i,1); save(); editR(); render(); }; }); }
function addT(){ const sc=el('#scope').value; const t=(el('#nt').value||'').trim(); const m=parseInt(el('#nmv').value||'0',10); if(!t) return alert('×™×© ×œ×›×ª×•×‘ ×›×•×ª×¨×ª ××©×™××”'); const it={id:crypto.randomUUID(),title:t}; if(!isNaN(m)&&m>0) it.minutes=m; if(sc==='morning') morning.push(it); else if(sc==='evening') evening.push(it); else motives.push(it); el('#nt').value=''; el('#nmv').value=''; save(); editR(); render(); }
function clearAll(){ if(!confirm('×œ× ×§×•×ª ××ª ×›×œ ×”× ×ª×•× ×™× ×©×œ ×”××¤×œ×™×§×¦×™×” ×”×–×•?')) return; ['tab','kidName','morningTasks','eveningTasks','motives','doneToday','coins','stars','shelf','voiceOn','voiceName','voiceRate','voicePitch'].forEach(k=>localStorage.removeItem(APP+':'+k)); location.reload(); }
function buy(s,c){ if(coins<c) return alert('×¦×¨×™×š ×¢×•×“ ××˜×‘×¢×•×ª!'); const i=shelf.findIndex(x=>!x); if(i===-1) return alert('×”××“×£ ××œ×!'); coins-=c; shelf[i]=s; save(); wallet(); shelfR(); }
function greet(){ if(tab==='morning') say('×‘×•×§×¨ ×˜×•×‘ ' + nameVal + ', ×‘×•× × ×ª×—×™×œ ×œ×‘×¦×¢ ××ª ××©×™××•×ª ×”×‘×•×§×¨ ×©×œ× ×•.'); else if(tab==='evening') say('×¢×¨×‘ ×˜×•×‘ ' + nameVal + ', × ×¡×™×™× ××ª ××©×™××•×ª ×”×¢×¨×‘ ×‘× ×¢×™××™×.'); else say('×›×œ ×”×›×‘×•×“ ' + nameVal + ', ×‘×•× × ×¡××Ÿ ×”×¦×œ×—×•×ª ×™×•××™×•××™×•×ª.'); }
function bind(){ el('#t1').onclick=()=>{ tab='morning'; save(); tabs(); render(); header(); greet(); }; el('#t2').onclick=()=>{ tab='evening'; save(); tabs(); render(); header(); greet(); }; el('#t3').onclick=()=>{ tab='achieve'; save(); tabs(); render(); header(); greet(); }; el('#kname').oninput=e=>{ nameVal=e.target.value; save(); header(); }; el('#clr').onclick=clearAll; el('#b1').onclick=()=>buy('ğŸ˜€',5); el('#b2').onclick=()=>buy('â­',5); el('#b3').onclick=()=>buy('ğŸ†',10); el('#scope').onchange=editR; el('#add').onclick=addT; const vOn=el('#von'), vSel=el('#vsel'), vr=el('#vr'), vp=el('#vp'); vOn.checked=!!voiceOn; vr.value=voiceRate; vp.value=voicePitch; vSel.addEventListener('change', ()=>{ voiceName=vSel.value; save(); }); vOn.addEventListener('change', ()=>{ voiceOn=vOn.checked; save(); }); vr.addEventListener('input', ()=>{ voiceRate=vr.value; save(); }); vp.addEventListener('input', ()=>{ voicePitch=vp.value; save(); }); el('#vtest').onclick=()=> say('×©×œ×•× ' + nameVal + '! ×‘×“×™×§×ª ×§×•×œ ×¢×•×‘×“×ª.'); el('#gx').onclick=()=> el('#gift').style.display='none'; }
function init(){ document.title='KidRoutine Son â­'; el('#kname').value=nameVal; tabs(); header(); render(); wallet(); shelfR(); bind(); editR(); }
let de=null; const ib=document.querySelector('#install'); window.addEventListener('beforeinstallprompt',e=>{ e.preventDefault(); de=e; ib.style.display='inline-block'; }); ib.onclick=async()=>{ if(!de) return; de.prompt(); const ch=await de.userChoice; if(ch.outcome==='accepted'){ document.querySelector('#st').textContent='××•×ª×§×Ÿ'; ib.style.display='none'; } }; window.addEventListener('appinstalled',()=>{ document.querySelector('#st').textContent='××•×ª×§×Ÿ'; ib.style.display='none'; }); if('serviceWorker' in navigator) window.addEventListener('load', ()=> navigator.serviceWorker.register('./sw.js').catch(()=>{})); document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
